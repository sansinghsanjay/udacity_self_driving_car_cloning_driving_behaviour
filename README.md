# Udacity Self Driving Car Nanodegree: Cloning Driving Behaviour

<p align="center">
<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/simulation_sample_output/video.gif">
</p>

## Objective
Train a neural network to clone the driving behaviour.

Here it is required to train a Convolutional Neural Network (CNN) to drive the car on a simulator provided by Udacity.

This CNN model is going to predict steering angle after looking at surrounding images, especially at lane lines.

Above is the sample output of this project.

## Introduction

### Self Driving Cars
Self Driving Cars are unmanned ground vehicles, also known as Autonomus Cars, Driverless Cars, Robotic Cars. 
<p align="center">
<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/images/self-driving-car.jpg">
</p>

### Technologies Used
Following are the technologies used by these Self Driving Cars to navigate:
1. Computer Vision and Machine Learning (AI) to find path, to classify traffic signs, etc.
2. Sensor Fusion to sense the surrounding moving vehicles.
3. Machine Learning (AI) for decision making.

### Why "Driving Behaviour"?
As Self Driving Car are completely auto-driven. For this, Deep Learning is used. With the help of a Deep Learning model, these cars are able to take left, right as well as keep themselves in their own lane.

## Programming Language
In this project, Python-3.5.2 is used with following packages:
1. numpy - 1.13.0
2. moviepy - 0.2.3.2
3. cv2 - 3.0.0 (Computer Vision)
4. keras - 2.0.8
<p align="center">
<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/technologies_used/technologies_used.png">
</p>

## About Udacity's Driving Simulator
Driving Simulator is like a video game. In this simulator we can control a car by using our mouse or keyboard buttons or by our trained model, similar to "need for speed" car race game. This simulator have two modes:
1. Training Mode: In this mode we can control car by using our mouse or keyboard. We can start recording by pressing ctrl+r keys. If recording is started, then this simulator keep saving images and angle of our steering angle while we driving the car by using mouse or keyboard buttons. We can use this saved data (images and steering angle) for training our CNN model.
2. Simulator Mode: This mode uses the trained CNN model to control the car. It keep passing images as input to model and get steering angle as predicted output. As per the output, it takes car left or right automatically.

## Model Architecture and Training Strategy
1. Convolutional Neural Network (CNN) is used here. This network is coded in Python (by using Keras API). Following is the architecture of CNN:
	1. Three convolutional layers are used here with {16, 32, 64} filters. 
	2. Two dense layers are used. 
	3. One maxpooling layer is used.
	4. One dropout layer is used here with 0.2 dropout rate.
	5. Adam optimizer is used here with learning rate 0.0009 and model is trained for 75 epochs.
2. Following is the information about dataset used here:
	1. Dataset provided by Udacity is used here.
	2. One lap of driving in opposite direction on track-1 (generated by using Udacity's simulator) is also used for training.
	3. Driving on dangerous blind turns in track-1 (in default direction) is also included in training set.
	4. Driving on bridge (of track-1) is also included here.
	5. Overall around 39000 images are used.
	6. Data is normalized.
	7. Images are cropped by using Cropping2D layer of Keras (to get "region of interest").
	8. 'steering' angles for left and right images are incremented and decremented by 0.2, respectively.
	9. 10% of all center images are used for validation.
	10. MSE (Mean Square Error) for training data after 75 epochs is: 0.0076 and R-square is: 0.8185.
	11. MSE for validation data is: 0.0211 and R-square is: -0.6917
	12. One line plot (val_plot.png) is included here. This plot is showing the closeness between actual steering value and predicted steering value for validation data.
	<p align="center">
	<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/plots/val_plot.png">
	</p>
	13. Following are the sample images of training data set:
	<p align="center">
	<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/sample_images/center_2017_07_24_21_10_01_956.jpg">
	<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/sample_images/center_2017_07_24_21_11_15_755.jpg">
	<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/sample_images/left_2017_07_15_16_28_17_457.jpg">
	<img src="https://github.com/sansinghsanjay/udacity_self_driving_car_cloning_driving_behaviour/blob/master/sample_images/right_2017_07_15_16_28_23_877.jpg">
	</p>
